# Mall Customer Segmentation And Classification
## Abstract
Stores usually launch offers, but how do they know what kind of offers could we need? 

Fortunately they're not spying us when we are talking or thinking about our necessities (or maybe yes). However, one of the many roads to discover deeper relationships between customer necessities and increasing store sales is by finding patterns in data, and that's what <b>Machine Learning</b> accomplishes perfectly.

## Unsupervised learning
This <b>Machine Learning</b> subarea refers to the use of <b>Artificial Intelligence</b> algorithms to detect patterns in data sets containing data points that are neither classified nor labeled.

## Solution
In order to finding groups of customers with common characteristics such as salary range or spending score proximity I will use a clustering algorithm known as <b>k-means</b>. This partitional algorithm is good at dividing groups of shuffled points and will help us to solve the key problem: separating data points into groups.

After that, I'll use a decision tree which implements the CART algorithm in order to finding specific boundaries to classify customers according to labels generated by the <b>k-means</b> algorithm.

### K-means
![Original dataset scatter graph](https://github.com/rcgc/MallCustomerSegmentation/blob/master/Figure_1_dataset.png)
<p><b>Image 1. </b>Original dataset scatter graph[1]</p><br><br>

![Elbow method graph](https://github.com/rcgc/MallCustomerSegmentation/blob/master/Figure_2_elbow_method.png)
<p><b>Image 2. </b>Elbow method graph</p><br><br>

![Clusters graph](https://github.com/rcgc/MallCustomerSegmentation/blob/master/Figure_3_clusters.png)
<p><b>Image 3. </b>Clusters graph</p><br>

#### Interpretation of clusters by customer group
| label | Annual Income (k$) | Spending score (1-100) |
| ----- | ------------------ | ---------------------- |
|  0ðŸŸ¢ |   low              |      low               |
|  1ðŸŸ¡ |   high             |      high              |
|  2ðŸ”´ |   medium           |      medium            |
|  3ðŸŸ£ |   low              |      high              |
|  4ðŸ”µ |   high             |      low               |
<br>


### Decision tree
![Decision_tree graph](https://github.com/rcgc/MallCustomerSegmentation/blob/master/Figure_4_decision_tree.png)
<p><b>Image 4. </b>Decision tree diagram</p><br>

<p>Value it's an array of label values from 0-4. So according to image 3, it can be undestood in the following way:</p>
<p>value = [ label0ðŸŸ¢, label1ðŸŸ¡, label2ðŸ”´, label3ðŸŸ£, label4ðŸ”µ ]</p>

#### How much is low, medium or high?
| label | Annual Income (k$) | Spending score (1-100) |
| ----- | ------------------ | ---------------------- |
|  0ðŸŸ¢ |   <= 38.5          |      <= 50.0           |
|  1ðŸŸ¡ |   > 68.5           |      >  51.5           |
|  2ðŸ”´ |   38.5 - 68.5      |      -                 |
|  3ðŸŸ£ |   <= 38.5          |      >  50.0           |
|  4ðŸ”µ |   > 68.5           |      <= 51.5           |
<br>

![Segmentation](https://github.com/rcgc/MallCustomerSegmentationAndClassification/blob/master/Figure_5_segmentation.png)
<p><b>Image 5. </b>Final segmentation</p><br>

## Requirements
- Python 3. https://www.python.org/downloads/
- Preferred IDE (optional). https://www.jetbrains.com/pycharm/
- Clone current repo
- Place into cloned repo folder

## How to use it
Run the .py files in the following order:
- `python kmeans.py` : will plot the original data, elbow diagram, kmeans clusters and will generate customer_segmentation.csv
- `python dt2.py` : will plot decision tree generated by checking customer_segmentation.csv (using scikit)
- `python decision_tree.py` : will display in console decision tree generated by checking customer_segmentation.csv (coded from scratch)
<br>

# References
[1]"Mall Customer Segmentation Data", Kaggle.com, 2021. [Online]. Available: https://www.kaggle.com/vjchoudhary7/customer-segmentation-tutorial-in-python?select=Mall_Customers.csv. [Accessed: 04- Nov- 2021].<br>
[2]"1.10. Decision Trees", scikit-learn, 2021. [Online]. Available: https://scikit-learn.org/stable/modules/tree.html. [Accessed: 04- Nov- 2021].<br>
[3]Gordon, J., 2021. Letâ€™s Write a Decision Tree Classifier from Scratch - Machine Learning Recipes #8. [online] Youtube.com. Available at: <https://www.youtube.com/watch?v=LDRbO9a6XPU&list=PLOU2XLYxmsIIuiBfYad6rFYQU_jL2ryal&index=9> [Accessed 4 November 2021].
